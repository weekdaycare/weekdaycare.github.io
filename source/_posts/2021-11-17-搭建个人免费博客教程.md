---
title: Hexo+GitHub+Vercel搭建个人博客
tags:
  - hexo
  - 技术
categories:
  - 捣鼓
abbrlink: build-blog
date: 2021-11-17 17:13:47
---

# 前言

近些年来很多用户都喜欢使用 GitHub Pages 来搭建 Hexo 静态博客网站，其最吸引人的莫过于完全免费使用，并且非常稳定。

虽然搭建时比较麻烦，有点折腾，但是配置完成后，基本不需要操心维护的事，甚至放了几年都忘记了，打开来看文章依然还在。

本文就详细介绍下如何使用 Hexo + GitHub 搭建免费个人博客网站的教程。

为了照顾小白用户（第一次使用 GitHub 和 Hexo），尽可能详细，包括常见的坑和问题都有提示说明。下面目录中**第 3~5 步为最重要的步骤**，其他内容如果已经会的可以选择性跳过。

o(￣▽￣)ｄ

# 简介

## **GitHub Pages 是什么？**

- [What is GitHub Pages? - GitHub Help](https://help.github.com/en/articles/what-is-github-pages)

GitHub Pages 是由 GitHub 官方提供的一种免费的静态站点托管服务，让我们可以在 GitHub 仓库里托管和发布自己的静态网站页面。

## **Hexo 是什么？**

- 官网：[hexo.io](https://hexo.io/zh-cn/)

> Hexo 是一个快速、简洁且高效的静态博客框架，它基于 Node.js 运行，可以将我们撰写的 Markdown 文档解析渲染成静态的 HTML 网页。

## **Hexo + GitHub 文章发布原理**

在本地撰写 Markdown 格式文章后，通过 Hexo 解析文档，渲染生成具有主题样式的 HTML 静态网页，再推送到 GitHub 上完成博文的发布。

![img](https://pic3.zhimg.com/80/v2-a193a47cf70fe6ecf156e5f3d34920ea_720w.jpg)

## **优点和不足**

**优点：**完全免费；静态站点，轻量快速；可按需求自由定制改造；托管在 GitHub，安全省心；迁移方便……

**不足：**发文不便，依赖于本地环境；更适合个人博客使用；GitHub 在国内访问速度有点不快（可用gitee代替github）。

# 准备

## **注意事项**

- 输入代码时，核对准确，最好切换成英文输入法；
- 将文中的 “用户名” 和 “邮箱” 替换为自己的 `GitHub` 账户名和绑定的邮箱；
- 统一使用 `Git Bash` 进行操作（支持 Win、Mac）；
- 小白请严格按步骤进行，不要跳！

## **环境搭建**

Hexo 基于 `Node.js`，搭建过程中还需要使用 `npm`（Node.js 已带） 和 `git`，因此先搭建本地操作环境，安装 `Node.js` 和 `Git`。

- Node.js：https://nodejs.org/zh-cn
- Git：https://git-scm.com/downloads

下载 `Node.js` 和 `Git` 程序并安装，一路点 “下一步” 按默认配置完成安装。

安装完成后，`Win+R` 输入 `cmd` 并打开，依次输入 `node -v`、`npm -v` 和 `git --version` 并回车，如下图出现程序版本号即可。

![img](https://pic1.zhimg.com/80/v2-27b47b5ae479ce7987851292a67774b0_720w.jpg)

# 连接 Github

使用邮箱注册 [GitHub](https://github.com/) 账户，选择免费账户（Free），并完成邮件验证。

右键 -> `Git Bash Here`，**设置用户名和邮箱**：

```bash
git config --global user.name "你的 GitHub 用户名"
git config --global user.email "你的 GitHub 邮箱"
```

**创建 SSH 密匙**：

输入 `ssh-keygen -t rsa -C "你的 GitHub 邮箱"`，然后一路回车。

**添加密匙：**

进入 `C:\Users\用户名\.ssh` 目录（要勾选显示“隐藏的项目”），用记事本打开公钥 `id_rsa.pub` 文件并复制里面的内容。

登陆 GitHub ，进入 Settings 页面，选择左边栏的 `SSH and GPG keys`，点击 `New SSH key`。

`Title` 随便取个名字，粘贴复制的 `id_rsa.pub` 内容到 `Key` 中，点击 `Add SSH key` 完成添加。

![img](https://pic1.zhimg.com/80/v2-9125065afd24332d7cd84feb6a350730_720w.jpg)

**验证连接：**

打开 `Git Bash`，输入 `ssh -T git@github.com` 出现 “Are you sure……”，输入 `yes` 回车确认。

![img](https://pic3.zhimg.com/80/v2-b4c7524a2451f4ab42f9c22ea3c7b6be_720w.jpg)

显示 “Hi xxx! You've successfully……” 即连接成功。

# 创建 Github Pages 仓库

GitHub 主页右上角加号 -> `New repository`：

- `Repository name` 中输入 `用户名.github.io`
- 勾选 “`Initialize this repository with a README`”
- `Description` 选填

填好后点击 `Create repository` 创建。

![img](https://pic2.zhimg.com/80/v2-67a8165154f4c5f4a6333e76e78ed815_720w.jpg)

创建后默认自动启用 HTTPS，博客地址为：`https://用户名.github.io`

# 本地安装 Hexo 博客程序

新建一个文件夹用来存放 `Hexo` 的程序文件，如 `Hexo-Blog`。打开该文件夹，右键 -> `Git Bash Here`。

## **安装 Hexo**

使用 `npm` 一键安装 `Hexo` 博客程序：

```bash
npm install -g hexo-cli
```

Mac 用户需要管理员权限（sudo），运行这条命令：

```bash
sudo npm install -g hexo-cli
```

安装时间有点久（真的很慢！），界面也没任何反应，**耐心等待**，安装完成后如下图。

![img](https://pic2.zhimg.com/80/v2-01e7fc8bb9280437deb437bf73a190a1_720w.jpg)

## **Hexo 初始化和本地预览**

**初始化并安装所需组件：**

```bash
hexo init      # 初始化
npm install    # 安装组件
```

完成后依次输入下面命令，**启动本地服务器进行预览**：

```bash
hexo g   # 生成页面
hexo s   # 启动预览
```

**访问** `http://localhost:4000`**，出现 Hexo 默认页面，本地博客安装成功！**

![img](https://pic4.zhimg.com/80/v2-1c3baeecf1ef3bec5c8ef3f14639f68b_720w.jpg)

**Tips：**如果出现页面加载不出来，可能是端口被占用了。Ctrl+C 关闭服务器，运行 `hexo server -p 5000` 更改端口号后重试。

Hexo 博客文件夹目录结构如下：

![img](https://pic1.zhimg.com/80/v2-264c75c0e493ae8cc5f283567c64ff2c_720w.jpg)

# 部署 Hexo 到 GitHub Pages

本地博客测试成功后，就是上传到 GitHub 进行部署，使其能够在网络上访问。

首先**安装 `hexo-deployer-git`**：

```bash
npm install hexo-deployer-git --save
```

然后**修改 `_config.yml`** 文件末尾的 `Deployment` 部分，修改成如下：

```bash
deploy:
  type: git
  repository: git@github.com:用户名/用户名.github.io.git
  branch: main
```

完成后运行 `hexo d` 将网站上传部署到 GitHub Pages。

完成！这时访问我们的 GitHub 域名 `https://用户名.github.io` 就可以看到 Hexo 网站了。

# 绑定域名（可选）

博客搭建完成使用的是 GitHub 的子域名（用户名.[http://github.io](http://github.io/)），我们可以为 Hexo 博客绑定自己的域名替换 GitHub 域名，更加个性化和专业，也利于 SEO。

## **域名注册和解析**

- 域名注册和解析教程：[Namesilo 域名购买及使用教程](https://zhuanlan.zhihu.com/p/33921436)

按上面教程注册并解析域名，在 DNS 设置部分，删除自带的记录，然后添加 CNAME 记录将 www 域名解析指向 `用户名.github.io`。

![img](https://pic3.zhimg.com/80/v2-d5d37c8ad523d8ab5c7c200fabc9585e_720w.jpg)

## **绑定域名到 Hexo 博客**

进入本地博客文件夹的 `source` 目录，打开记事本，里面输入自己的域名，如 http://www.example.com，保存名称为 `CNAME`，格式为 “所有文件”（无 .txt 后缀）。

清除缓存等文件并重新发布网站：

```bash
hexo clean   # 清除缓存文件等
hexo g       # 生成页面
hexo s       # 启动预览
```

现在就可以使用自己的域名访问 Hexo 博客了。

## **开启 HTTPS**

配置自己的域名后，需要我们手动开启 `HTTPS`。打开博客所在 GitHub 仓库，`Settings` -> 下拉找到 `GitHub Pages` -> 勾选 `Enforce HTTPS`。

![img](https://pic4.zhimg.com/80/v2-54f8744afc9746884e6b3acecfc5f8cf_720w.jpg)

HTTPS 证书部署成功需要一定时间，等大概几分钟再访问域名，就可以看到域名前面的小绿锁了，HTTPS 配置完成！

# 开始使用

## **发布文章**

进入博客所在目录，右键打开 `Git Bash Here`，创建博文：

```bash
hexo new "你的文章"
```

然后 `source` 文件夹中会出现一个 `你的文章.md` 文件，就可以使用 Markdown 编辑器在该文件中撰写文章了。

写完后运行下面代码将文章渲染并部署到 `GitHub Pages` 上完成发布。

> **以后每次发布文章都是这两条命令。**

```bash
hexo g   # 生成页面
hexo d   # 部署发布
```

------

也可以不使用命令自己创建 `.md` 文件，只需在文件开头手动加入如下格式 `Front-matter` 即可，写完后运行 `hexo g` 和 `hexo d` 发布。

```text
---
title: Hello World # 标题
date: 2019/3/26 hh:mm:ss # 时间
categories: # 分类
- Diary
tags: # 标签
- PS3
- Games
---

摘要
<!--more-->
正文
```

## **网站设置**

包括网站名称、描述、作者、链接样式等，全部在网站目录下的 `_config.yml` 文件中，参考[官方文档](https://hexo.io/zh-cn/docs/configuration)按需要编辑。

> **注意：冒号后要加一个空格！**

## **更换主题**

> 不同主题安装方式不一定相同，有的是`git clone`，有的是`npm`安装，请注意你想安装的主题的官方文档

在 [Themes | Hexo](https://hexo.io/themes/) 选择一个喜欢的主题，比如 [NexT](http://theme-next.iissnan.com/getting-started.html)，进入网站目录打开 `Git Bash Here` 下载主题：

```bash
git clone https://github.com/iissnan/hexo-theme-next themes/next
```

然后修改 `_config.yml` 中的 `theme` 为新主题名称 `next`，发布。（有的主题需要将 `_config.yml` 替换为主题自带的，参考主题说明。）

## **常用命令**

```bash
hexo new "name"       # 新建文章
hexo new page "name"  # 新建页面
hexo g                # 生成页面
hexo d                # 部署
hexo g -d             # 生成页面并部署
hexo s                # 本地预览
hexo clean            # 清除缓存和已生成的静态文件
hexo help             # 帮助
```

# Vercel

<div class="warning">

> 注意：2022/8/28日消息 `vercel.app` 域名在中国已被DNS污染，vercel仍可使用，不过要想直连到你的网站，建议使用个人域名代替vercel.app的域名

</div>


## **为什么选择 vercel**

1. Vercel支持多个开发框架(Next.js,create-react-app,Nuxt.js)
2. Vercel内置的CI / CD系统会在每次代码更改时触发，推送代码后自动部署
3. 支撑一键导入GitHub/Gitlagb仓库和站点
4. 全球CDN加速
5. 穷

各种托管网站看似鱼龙混杂，其实由于各种原因，在国内能用的也就那么几家；如果你像我一样，没有服务器、没有备案，还想白嫖（bushi），那么仅有的选择就更少了。

综合各种因素，目前最适合托管静态博客的服务有：

## GitHub Pages 

微软旗下，闻名遐迩的全球第一大开源仓库网站。服务器设在荷兰、美国等地。部分地区部分运营商的用户可能遭到 DNS 污染，无法正常访问。

## Gitee Pages 

OSCHINA 旗下，服务器在上海腾讯云，速度较快，较稳定，提供 xxx.gitee.io 域名，不支持免费自定义域名。 

## 旧 Coding Pages 

腾讯旗下，服务器在香港 / 新加坡腾讯云，速度较快，但稳定性差。部分地区速度极慢或不能访问。支持免费自定义域名。 

## 新 Coding Pages 

与腾讯云绑定食用，功能较齐全，但按量计费。 

# Vercel 的使用

原名 Zeit，服务器在美国，在港台有 CDN 节点。速度略慢于 Coding，但大部分地区均可正常访问。提供自定义 `xxx.vercel.app`域名，且支持免费绑定个人域名。 

大部分网站采用的一般都是 GitHub + Coding 双部署的形式。这种方法比较麻烦，需要 DNSPod 解析，因此需要实名认证，而且还真未必快到那里去。 Colsrch 大佬出过一篇三部署教程，使用了 Coding（联通线路），Vercel（默认线路），Cloudflare 回源 GitHub Page（移动线路），速度略有提升，但是门槛较高，对小白并不友好。

## GitHub登录Vercel

进入[Vercel官网](https://vercel.com/) ，依次点击` sign up - Continue with GitHub`
![img](https://cdn.jsdelivr.net/gh/lzyblog/image@main/2021/01/12/1256a9be123fde483bace4fd05e17536.png)

> 注意GitHub账户绑定的主邮箱📪，有可能QQ邮箱会出现无法使用GitHub账号登陆Vercel的情况，推荐将GitHub主邮箱改为谷歌邮箱，不会改可以问下度娘[GitHub更换邮箱（简单粗暴）](https://blog.csdn.net/weixin_44170221/article/details/104495373)

## 导入仓库

选择` Import Git Repository` 然后`Continue`输入你仓库的url就行了（https）
![img](https://cdn.jsdelivr.net/gh/lzyblog/image@main/2021/01/12/d128335e72b7e75d773beac2a40389d7.png)
![img](https://cdn.jsdelivr.net/gh/lzyblog/image@main/2021/01/12/bbe2228105097d3454bfd26e310167e8.png)
![img](https://cdn.jsdelivr.net/gh/lzyblog/image@main/2021/01/12/966e48109815be945982e2900c267980.png)

> 导入静态页面仓库之前，需要为你的 Github 安装 Vercel(`setting-Application`)，此处建议选择 `All repositories`，意为为所有仓库安装，当然，你也可以选择只为当前仓库安装，也就是 `Only select repositories`。

![img](https://cdn.jsdelivr.net/gh/lzyblog/image@d371e6f9b563c89102d09022aecd63be82f4585b/2021/01/13/861d72398058c66d70db423964d998bd.png)

> 下方三个选项保持默认就好，因为 `username.github.io` 的 `main` 分支内是本身就已经部署好的静态页面，所以没必要选择特定的框架去再次编译。

![img](https://cdn.jsdelivr.net/gh/lzyblog/image@b6b66c9dff54ac6b3dd70d5a59fb7c77cb4f9bb2/2021/01/13/dca048cca90e5b41b632ff3a4d6bafe0.png)

> 注：2020 年 10 月后 github 新建仓库默认分支改为 main

> 导入之后可以访问，说明部署成功！

# 常见问题

## **Hexo 设置显示文章摘要，首页不显示全文**

Hexo 主页文章列表默认会显示文章全文，浏览时很不方便，可以在文章中插入 `<!--more-->` 进行分段。

该代码前面的内容会作为摘要显示，而后面的内容会替换为 “Read More” 隐藏起来。

![img](https://pic4.zhimg.com/80/v2-45701cf120ca77e6733ad30b40666f33_720w.jpg)

## **修改并部署后没有效果**

使用 `hexo clean` 清理后重新部署。

## **开启 HTTPS 后访问网站显示连接不安全？**

证书还未部署生效，等待一会儿，清除浏览器缓存再试。

## **Mac 安装 Hexo 报错无法安装**

Mac 用户需要管理员权限运行，使用 `sudo npm install -g hexo-cli` 命令安装。

## **npm 下载速度慢，甚至完全没反应**

使用 `npm` 安装程序等待很久也没反应，或者下载速度很慢，可以更换 npm 源为国内 npm 镜像。

临时更换方法：在 `npm` 安装命令后面加上：

```bash
--registry https://registry.npm.taobao.org 
```

## **Connection refused**

```bash
$ hexo d
提示如下报错
ssh: connect to host github.com port 22: Connection refused
fatal: Could not read from remote repository.

Please make sure you have the correct access rights
and the repository exists.
```

`ssh: connect to host github.com port 22: Connection refused`这个错误提示的是连接`github.com`的22端口被拒绝了

使用GitHub的443端口，22端口可能被防火墙屏蔽了，可以尝试连接GitHub的443端口

### 解决方法
输入以下指令
```bash
$ vim ~/.ssh/config
```
点按`i`进行编辑

```bash
# 添加以下代码
Host github.com
  Hostname ssh.github.com
  Port 443
```
编辑完成后按`Esc`退出编辑，输入`:wq`退出并保存，输入

```bash
$ ssh -T git@github.com
```

如果提示以下报错

```bash
The authenticity of host '[ssh.github.com]:443 ([192.30.253.123]:443)' can't be established.
RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
```
然后下面还有这样的提示：选择 `yes`
```bash
Are you sure you want to continue connecting (yes/no)? yes
```
其实是少了一个`known_hosts`文件，本来密钥文件应该是三个，现在是两个，便报了这样的错误，此时选择`yes`回车之后，便可，同时生成了缺少了的`known_hosts`文件：

![](https://img-blog.csdnimg.cn/20190521101659202.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ZlYXJsZXNzeG1t,size_16,color_FFFFFF,t_70)

然后，再试试`hexo d`,如果还是报错的话，就将远程仓库对应的密钥删掉，重新将`rsa.pub`添加为新的密钥就可以了

若没有出现如上报错就不用管了，运行以下代码

```bash
$ ssh -T git@github.com
```

出现以下提示信息就OK了

~~~bash
Hi xxxxx! You've successfully authenticated, but GitHub does not
provide shell access.
~~~

要是无效的话，就看这个贴子吧

[坑：ssh: connect to host github.com port 22: Connection refused - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/521340971)

## branch 'master' set up to track 'git@github.com:weekdaycare/weekdaycare.github.io.git/main'.

出现类似以上代码的，删除`.deploy_git`文件夹并重新运行`hexo g -d`

详细见[Branch master set up to track remote branch master from git@github.com:ifgyong/ifgyong.github.io.git. · Issue #1734 · hexojs/hexo](https://github.com/hexojs/hexo/issues/1734)

## ERROR Process failed

使用`hexo s`或`hexo g`终端命令是报错`ERROR Process failed: _posts/name.md`，如下图

```text
reason: 'bad indentation of a mapping entry',
    mark: {
      name: null,
      buffer: 'title: Hexo+GitHub+Vercel搭建个人博客\n' +
        'date: 2021-11-17 17:13:47\n' +
        'tags: [hexo][技术]\n' +
        'categories: [捣鼓]\n',
      position: 70,
      line: 2,
      column: 12,
      snippet: ' 1 | title: Hexo+GitHub+Vercel搭建个人博客\n' +
        ' 2 | date: 2021-11-17 17:13:47\n' +
        ' 3 | tags: [hexo][技术]\n' +
        '-----------------^\n' +
        ' 4 | categories: [捣鼓]'
    }
  }
} Process failed: %s
```

原因：MD语法错误，自行前往文章进行修改，大概率是`Front-matter`出错
