var searchFunc=function(t,e,n,s,r){$.ajax({url:t,dataType:"json",success:function(t){const c=t,a=document.getElementById(s);if(!a)return;const o=document.getElementById(r),i=document.getElementById(n),l=function(t,e){let n;return function(...s){clearTimeout(n),n=setTimeout((()=>t.apply(this,s)),e)}}((function(){const t=[],n=this.value.trim().toLowerCase();if(n.length<=0)return i.setAttribute("searching","false"),void(o.innerHTML="");i.setAttribute("searching","true");const s=function(t){let e=[];const n=t.length;for(let s=0;s<n;s++)for(let r=s+1;r<=n;r++)e.push(t.slice(s,r).join(" "));return e}(n.split(" ")).sort(((t,e)=>e.split(" ").length-t.split(" ").length));c.forEach((n=>{if(!n.content||!n.content.trim().length)return;if(e&&!n.path.includes(e))return;const r=n.title?.trim()||"Untitled",c=r.toLowerCase(),a=n.content,o=a.toLowerCase(),i=n.path.startsWith("//")?n.path.slice(1):n.path;let l=0,u=-1;if(s.forEach((t=>{const e=c.indexOf(t),n=o.indexOf(t);(e>=0||n>=0)&&(l+=1,n<0?u=0:u<0&&(u=n))})),l>0){let e="";if(u>=0){let t=Math.max(u-20,0),n=Math.min(u+80,a.length);e=a.substring(t,n);const r=new RegExp(s.join("|"),"gi");e=e.replace(r,(t=>`<span class="search-keyword">${t}</span>`))}t.push({rank:l,str:`\n                <li>\n                  <a href="${i}">\n                    <span class="search-result-title">${r}</span>\n                    ${e?`<p class="search-result-content">${e}...</p>`:""}\n                  </a>\n                </li>\n              `})}})),t.length?(t.sort(((t,e)=>e.rank-t.rank)),o.innerHTML=`<ul class="search-result-list">${t.map((t=>t.str)).join("")}</ul>`):o.innerHTML=""}),300);a.addEventListener("input",l)}})};utils.jq((()=>{$((function(){const t=$("#search-input");if(0==t.length)return;const e=$("#search-result");t.focus((function(){let e=ctx.search.path;e.startsWith("/")&&(e=e.substring(1)),e=ctx.root+e;const n=t.attr("data-filter")||"";searchFunc(e,n,"search-wrapper","search-input","search-result")})),t.keydown((function(t){13==t.which&&t.preventDefault()}));new MutationObserver((function(t){1==t.length&&(t[0].addedNodes.length?$(".search-wrapper").removeClass("noresult"):t[0].removedNodes.length&&$(".search-wrapper").addClass("noresult"))})).observe(e[0],{childList:!0});const n=$("#search-wrapper"),s=$("#search-mask"),r=e=>{const r=e?"fadeIn":"fadeOut";n.stop(!0,!0)[r](300),s.stop(!0,!0)[r](300),e?t.focus():c()},c=()=>{t.val(""),e.html("")};$("#search-button a").on("click",(()=>r(!0))),s.on("click",(()=>r(!1))),$("#search-close").on("click",(()=>r(!1))),$("#search-clear").on("click",c)}))}));