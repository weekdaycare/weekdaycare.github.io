utils.jq((()=>{$((function(){const e=document.querySelector(".ds-twikoo");utils.onLoading(e);const t=e.getAttribute("api"),i=parseInt(e.getAttribute("limit"))||10,a="reply"!==e.getAttribute("hide");t&&fetch(t,{method:"POST",body:JSON.stringify({event:"GET_RECENT_COMMENTS",envId:t,pageSize:i,includeReply:a}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((({data:t})=>{utils.onLoadSuccess(e),t.forEach(((t,i)=>{let a=t.commentText;if(a&&""!==a.trim()){a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),a=a.length>50?a.substring(0,50)+"...":a;var n='<div class="timenode" index="'+i+'">';n+='<div class="header">',n+='<div class="user-info">',n+="<span>"+t.nick+"</span>",n+="</div>",n+="<span>"+new Date(t.created).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1})+"</span>",n+="</div>",n+='<a class="body" href="'+t.url+"#"+t.id+'">',n+=a,n+="</a>",n+="</div>",$(e).append(n)}}))})).catch((()=>utils.onLoadFailure(e)))}))}));